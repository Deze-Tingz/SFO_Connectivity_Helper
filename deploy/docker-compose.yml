version: '3.8'

services:
  signaling:
    build:
      context: ..
      dockerfile: deploy/Dockerfile.signaling
    ports:
      - "8080:8080"
    environment:
      - SIGNALING_PORT=8080
      - SIGNALING_SECRET=${SIGNALING_SECRET:-changeme}
      - SESSION_TTL_MINUTES=15
    restart: unless-stopped

  relay:
    build:
      context: ..
      dockerfile: deploy/Dockerfile.relay
    ports:
      - "8443:8443"
    environment:
      - RELAY_PORT=8443
      - SIGNALING_SECRET=${SIGNALING_SECRET:-changeme}
      - SIGNALING_URL=http://signaling:8080
      - MAX_SESSION_HOURS=4
    depends_on:
      - signaling
    restart: unless-stopped
